<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Oops, My Vibe!</title>
  <link rel="stylesheet" href="front1_style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic&display=swap" rel="stylesheet">
</head>
<body>

  <div class="container">
    <h1 class="title">Oops, My Vibe!</h1>
    <button class="play-button"><span>play</span></button>
  </div>

  <!-- ✅ 로그인 영역 (드롭다운 포함) -->
  <div class="login-wrapper" id="loginWrapper" style="position: absolute; top: 20px; right: 30px;">
    <div class="login-text" id="loginDisplay">로그인</div>
    <div class="user-dropdown" id="userDropdown" style="display: none; position: absolute; right: 0; top: 100%; background: white; border: 1px solid #ccc; border-radius: 4px;">
      <button id="goMypage">마이페이지</button>
      <button id="logoutBtn">로그아웃</button>
    </div>
  </div>

  <!-- 로그인 모달 -->
  <div id="loginModal" class="login-modal">
    <div class="login-modal-content">
      <button id="closeLoginModal" class="close-login-modal">×</button>
      <h2 class="modal-title">로그인</h2>
      <form action="/login" method="POST">
        <input type="text" name="username" class="modal-input" placeholder="id" required />
        <input type="password" name="password" class="modal-input" placeholder="Password" required />
        <button type="submit" class="login-submit">로그인</button>
      </form>
      <div class="modal-footer">
        <span class="footer-text">계정이 없나요?</span>
        <span id="openSignup" class="footer-link">회원가입</span>
      </div>
    </div>
  </div>

  <!-- 회원가입 모달 -->
  <div id="signupModal" class="login-modal">
    <div class="login-modal-content">
      <button id="closeSignupModal" class="close-login-modal">×</button>
      <h2 class="modal-title">회원가입</h2>
      <form action="/register" method="POST">
        <input type="text" name="nickname" class="modal-input" placeholder="Username" required />
        <input type="text" name="username" class="modal-input" placeholder="id" required />
        <input type="password" name="password" class="modal-input" placeholder="Password" required />
        <input type="password" name="confirm" class="modal-input" placeholder="Password 확인" required />
        <button type="submit" class="login-submit">가입하기</button>
      </form>
    </div>
  </div>

  <!-- 사이드바 및 오버레이 -->
  <input type="checkbox" id="menuToggle" class="menu-toggle"/>
  <label for="menuToggle" class="menu-icon" data-open="☰" data-close="✕"></label>
  <div class="overlay"></div>

  <div class="sidebar">
    <div class="tag-list">
      <div class="tag">팝🎤</div>
      <div class="tag">록🎸</div>
      <div class="tag">힙합🎧</div>
      <div class="tag">R&B🎹</div>
      <div class="tag">EDM🎛️</div>
      <div class="tag">재즈🎷</div>
      <div class="tag">펑크🪧</div>
      <div class="tag">K-Pop✨</div>
      <div class="tag">발라드💧</div>
      <div class="tag">인디😎</div>
      <div class="tag">메탈🤘</div>
      <div class="tag">클래식🎻</div>
    </div>
  </div>

  <!-- 안내 팝업 -->
  <div id="guidePopup" class="guide-popup">
    <button id="closePopup" class="close-btn">×</button>
    <h3>🎵 지금 이 순간, 딱 맞는 음악을 추천해드립니다! 🎵</h3>
    <span class="star" style="left: 5%; animation-delay: 0s;">⭐️</span>
    <span class="star" style="left: 20%; animation-delay: 0.5s;">⭐️</span>
    <span class="star" style="left: 40%; animation-delay: 1.1s;">⭐️</span>
    <span class="star" style="left: 60%; animation-delay: 1.8s;">⭐️</span>
    <span class="star" style="left: 80%; animation-delay: 1.5s;">⭐️</span>
    <span class="star" style="left: 95%; animation-delay: 0.7s;">⭐️</span>
    <p>현재 날씨와 시간대를 반영해 최적의 플레이리스트를 큐레이션합니다.<br>
    ☀️ 상쾌한 아침부터 🌙 감성적인 밤까지, 언제든 당신에게 어울리는 음악을 만나보세요!</p>
    <p>🔍 <strong>실시간 맞춤 추천 | 무드 기반 플레이리스트</strong><br>
      <a href="/music_form" class="listen-link">🎧 지금 바로 들어보세요!</a>

    </p>
  </div>

  <!-- 스크립트 -->
  <script>
    // 음악 추천 팝업 제어
    const playButton = document.querySelector('.play-button');
    const guidePopup = document.getElementById('guidePopup');
    const closePopupButton = document.getElementById('closePopup');

    guidePopup.style.display = 'none';
    playButton.addEventListener('click', () => guidePopup.style.display = 'block');
    closePopupButton.addEventListener('click', () => guidePopup.style.display = 'none');
  </script>

<script>
  // 로그인 모달 & 회원가입 모달 제어 (loginText는 제외!)
  const loginModal = document.getElementById('loginModal');
  const closeLoginBtn = document.getElementById('closeLoginModal');

  closeLoginBtn.addEventListener('click', () => loginModal.classList.remove('active'));
  loginModal.addEventListener('click', e => { if (e.target === loginModal) loginModal.classList.remove('active'); });

  const openSignupBtn = document.getElementById('openSignup');
  const signupModal = document.getElementById('signupModal');
  const closeSignupBtn = document.getElementById('closeSignupModal');

  openSignupBtn.addEventListener('click', () => {
    loginModal.classList.remove('active');
    signupModal.classList.add('active');
  });
  closeSignupBtn.addEventListener('click', () => signupModal.classList.remove('active'));
  signupModal.addEventListener('click', e => { if (e.target === signupModal) signupModal.classList.remove('active'); });
</script>

 

<script>
  window.addEventListener('DOMContentLoaded', async () => {
    const res = await fetch('/session-user');
    const data = await res.json();

    const loginText = document.getElementById('loginDisplay');
    const dropdown = document.getElementById('userDropdown');

    if (data.username) {
      loginText.textContent = `${data.username}님`;
      loginText.style.cursor = 'pointer';

      loginText.addEventListener('click', () => {
        dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
      });

      document.addEventListener('click', (e) => {
        if (!loginText.contains(e.target) && !dropdown.contains(e.target)) {
          dropdown.style.display = 'none';
        }
      });

      document.getElementById('goMypage').addEventListener('click', () => {
        window.location.href = '/mypage.html';
      });

      document.getElementById('logoutBtn').addEventListener('click', () => {
        window.location.href = '/logout';
      });

    } else {
      loginText.addEventListener('click', () => {
        document.getElementById('loginModal').classList.add('active');
      });
    }
  });
</script>


</body>
</html>
